<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API - –†–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π –ü–æ—Ä—Ç–∞–ª</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .section {
            margin-bottom: 30px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
        }
        .section h2 {
            color: #333;
            margin-top: 0;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        .endpoint {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
        }
        .method {
            font-weight: bold;
            color: #007bff;
        }
        .url {
            font-family: monospace;
            background: #e9ecef;
            padding: 5px 10px;
            border-radius: 3px;
            margin: 5px 0;
        }
        .response {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .loading {
            color: #6c757d;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API - –†–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π –ü–æ—Ä—Ç–∞–ª</h1>

        <div class="section">
            <h2>üìä –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã</h2>
            <button onclick="testHealth()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Health Check</button>
            <div id="health-status"></div>
        </div>

        <div class="section">
            <h2>üìù –ü–æ—Å—Ç—ã</h2>

            <div class="endpoint">
                <div class="method">GET</div>
                <div class="url">/api/posts</div>
                <button onclick="getPosts()">–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø–æ—Å—Ç—ã</button>
                <div id="posts-response"></div>
            </div>

            <div class="endpoint">
                <div class="method">GET</div>
                <div class="url">/api/posts/:id</div>
                <input type="text" id="post-id" placeholder="ID –ø–æ—Å—Ç–∞" value="1">
                <button onclick="getPost()">–ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å—Ç</button>
                <div id="post-response"></div>
            </div>

            <div class="endpoint">
                <div class="method">POST</div>
                <div class="url">/api/posts</div>
                <input type="text" id="new-post-content" placeholder="–¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞" style="width: 300px;">
                <button onclick="createPost()">–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç</button>
                <div id="create-post-response"></div>
            </div>

            <div class="endpoint">
                <div class="method">POST</div>
                <div class="url">/api/posts/:id/like</div>
                <input type="text" id="like-post-id" placeholder="ID –ø–æ—Å—Ç–∞" value="1">
                <button onclick="likePost()">–ü–æ—Å—Ç–∞–≤–∏—Ç—å –ª–∞–π–∫</button>
                <div id="like-response"></div>
            </div>
        </div>

        <div class="section">
            <h2>üí¨ –§–æ—Ä—É–º</h2>

            <div class="endpoint">
                <div class="method">GET</div>
                <div class="url">/api/forum</div>
                <button onclick="getForums()">–ü–æ–ª—É—á–∏—Ç—å —Ñ–æ—Ä—É–º—ã</button>
                <div id="forums-response"></div>
            </div>

            <div class="endpoint">
                <div class="method">GET</div>
                <div class="url">/api/forum/:id/topics</div>
                <input type="text" id="forum-id" placeholder="ID —Ñ–æ—Ä—É–º–∞" value="1">
                <button onclick="getTopics()">–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–ø–∏–∫–∏</button>
                <div id="topics-response"></div>
            </div>

            <div class="endpoint">
                <div class="method">POST</div>
                <div class="url">/api/forum/:id/topics</div>
                <input type="text" id="topic-forum-id" placeholder="ID —Ñ–æ—Ä—É–º–∞" value="1" style="width: 100px;">
                <input type="text" id="topic-title" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫" style="width: 200px;">
                <input type="text" id="topic-content" placeholder="–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ" style="width: 200px;">
                <button onclick="createTopic()">–°–æ–∑–¥–∞—Ç—å —Ç–æ–ø–∏–∫</button>
                <div id="create-topic-response"></div>
            </div>
        </div>

        <div class="section">
            <h2>üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h2>

            <div class="endpoint">
                <div class="method">GET</div>
                <div class="url">/api/users/:id</div>
                <input type="text" id="user-id" placeholder="ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" value="1">
                <button onclick="getUser()">–ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button>
                <div id="user-response"></div>
            </div>

            <div class="endpoint">
                <div class="method">POST</div>
                <div class="url">/api/auth/login</div>
                <input type="email" id="login-email" placeholder="Email" value="test@example.com" style="width: 200px;">
                <input type="password" id="login-password" placeholder="–ü–∞—Ä–æ–ª—å" value="password" style="width: 150px;">
                <button onclick="login()">–í–æ–π—Ç–∏</button>
                <div id="login-response"></div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:3000';

        async function makeRequest(method, url, data = null) {
            const config = {
                method: method,
                headers: {
                    'Content-Type': 'application/json',
                },
            };

            if (data) {
                config.body = JSON.stringify(data);
            }

            try {
                const response = await fetch(API_BASE + url, config);
                const result = await response.json();
                return { success: true, data: result, status: response.status };
            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        function showResponse(elementId, result) {
            const element = document.getElementById(elementId);
            element.innerHTML = '';

            if (result.success) {
                element.innerHTML = `<div class="response">${JSON.stringify(result.data, null, 2)}</div>`;
            } else {
                element.innerHTML = `<div class="response error">${result.error}</div>`;
            }
        }

        async function testHealth() {
            const statusDiv = document.getElementById('health-status');
            statusDiv.innerHTML = '<div class="loading">–ü—Ä–æ–≤–µ—Ä–∫–∞...</div>';

            const result = await makeRequest('GET', '/health');
            statusDiv.innerHTML = result.success
                ? `<div class="status success">‚úÖ –°–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç! –°—Ç–∞—Ç—É—Å: ${result.status}</div>`
                : `<div class="status error">‚ùå –û—à–∏–±–∫–∞: ${result.error}</div>`;
        }

        async function getPosts() {
            showResponse('posts-response', await makeRequest('GET', '/api/posts'));
        }

        async function getPost() {
            const postId = document.getElementById('post-id').value;
            showResponse('post-response', await makeRequest('GET', `/api/posts/${postId}`));
        }

        async function createPost() {
            const content = document.getElementById('new-post-content').value;
            showResponse('create-post-response', await makeRequest('POST', '/api/posts', { content, mediaUrls: [] }));
        }

        async function likePost() {
            const postId = document.getElementById('like-post-id').value;
            showResponse('like-response', await makeRequest('POST', `/api/posts/${postId}/like`));
        }

        async function getForums() {
            showResponse('forums-response', await makeRequest('GET', '/api/forum'));
        }

        async function getTopics() {
            const forumId = document.getElementById('forum-id').value;
            showResponse('topics-response', await makeRequest('GET', `/api/forum/${forumId}/topics`));
        }

        async function createTopic() {
            const forumId = document.getElementById('topic-forum-id').value;
            const title = document.getElementById('topic-title').value;
            const content = document.getElementById('topic-content').value;

            showResponse('create-topic-response', await makeRequest('POST', `/api/forum/${forumId}/topics`, { title, content }));
        }

        async function getUser() {
            const userId = document.getElementById('user-id').value;
            showResponse('user-response', await makeRequest('GET', `/api/users/${userId}`));
        }

        async function login() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;

            showResponse('login-response', await makeRequest('POST', '/api/auth/login', { email, password }));
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            testHealth();
        };
    </script>
</body>
</html>
